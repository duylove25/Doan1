<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quản Lý Nguyên Liệu</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .container { max-width: 960px; margin: auto; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    table th, table td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    table th { background-color: #f8f8f8; }
    .out-of-stock { color: red; font-weight: bold; }
    form { margin-top: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background: #fafafa; }
    form input, form select, form button { margin: 8px 0; padding: 8px; width: 100%; }
    #saveButton { background-color: #4CAF50; color: white; }
    #saveButton:hover { background-color: #45a049; }
    .delete-btn { background: red; color: white; border: none; padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const role = sessionStorage.getItem('role');
      if (!role) {
        alert('Bạn cần đăng nhập!');
        window.location.href = 'login.html?redirect=ingredients';
        return;
      }
      if (!['Quản lý', 'Bếp', 'Bếp trưởng', 'Thu ngân'].includes(role)) {
        document.body.innerHTML = '<p style="text-align:center; margin-top:50px; font-size:20px; color:red;">Bạn không có quyền truy cập trang này.</p>';
        return;
      }
      if (role !== 'Quản lý') {
        const formSection = document.getElementById('logForm');
        if (formSection) formSection.style.display = 'none';
        const formTitle = document.querySelector('.form-title');
        if (formTitle) formTitle.style.display = 'none';
      }
    });
  </script>

  <div class="container">
    <h1>Quản Lý Kho Nguyên Liệu</h1>
    <div id="statusMessage" style="color:red;font-weight:bold;margin-bottom:15px;"></div>

    <h2>Danh Sách Nguyên Liệu</h2>
    <table id="ingredientTable">
      <thead>
        <tr>
          <th>Tên</th>
          <th>Đơn vị</th>
          <th>Số lượng</th>
          <th>Ghi chú</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h2 class="form-title">➕ Nhập/Xuất Kho</h2>
    <form id="logForm">
      <label for="ingredient-name">Tên nguyên liệu:</label>
      <input type="text" id="ingredient-name" required>
      <label for="ingredient-unit">Đơn vị:</label>
      <input type="text" id="ingredient-unit" placeholder="Ví dụ: kg, lít">
      <label for="action">Loại:</label>
      <select id="action">
        <option value="add">Nhập kho</option>
        <option value="subtract">Xuất kho</option>
      </select>
      <label for="quantity">Số lượng:</label>
      <input type="number" id="quantity" min="1" step="0.01" required>
      <label for="note">Ghi chú:</label>
      <input type="text" id="note">
      <button type="submit" id="saveButton">Lưu</button>
    </form>

    <h2>Lịch sử Nhập/Xuất Kho</h2>
    <table id="logTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nguyên liệu</th>
          <th>Loại</th>
          <th>Số lượng</th>
          <th>Thời gian</th>
          <th>Ghi chú</th>
          <th>Hành động</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <a href="index.html" style="display:block;text-align:center;margin-top:20px;color:#007bff;text-decoration:none;">Quay lại trang chính</a>
  </div>

  <script src="ingredients.js"></script>
</body>
</html>
