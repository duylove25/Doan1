<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quáº£n LÃ½ Gá»i MÃ³n & TÃ­nh Bill</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Kiá»ƒm tra Ä‘Äƒng nháº­p vÃ  phÃ¢n quyá»n -->
    <script>
        const isLoggedIn = sessionStorage.getItem('isLoggedIn');
        if (isLoggedIn !== 'true') {
            alert('Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ sá»­ dá»¥ng há»‡ thá»‘ng!');
            window.location.href = 'login.html?redirect=index';
        }
    </script>

    <div class="container">
        <div class="header-logo">
            <img src="image/logo.png" alt="Logo" />
        </div>
        <h1>Quáº£n LÃ½ Gá»i MÃ³n & Thanh ToÃ¡n</h1>

        <div class="table-selection-section">
            <h2>Chá»n BÃ n</h2>
            <div id="tableList" class="table-grid">
                <!-- BÃ n sáº½ Ä‘Æ°á»£c render bá»Ÿi script.js -->
            </div>
            <p id="selectedTableInfo">ChÆ°a chá»n bÃ n nÃ o.</p>
        </div>

        <div class="main-order-section">
            <div class="menu-section">
                <h2>Thá»±c Ä‘Æ¡n</h2>
                <div id="menuItems" class="menu-grid">
                </div>
            </div>

            <div class="order-bill-section">
                <h2>ÄÆ¡n hÃ ng bÃ n: <span id="currentTableName">ChÆ°a chá»n</span></h2>
                <div class="order-summary">
                    <ul id="orderList">
                        <li class="empty-order-message">Chá»n bÃ n vÃ  thÃªm mÃ³n Ä‘á»ƒ báº¯t Ä‘áº§u order.</li>
                    </ul>
                    <p class="total-amount">Tá»•ng cá»™ng: <span id="totalAmount">0</span> VND</p>
                    <button id="checkoutBtn" disabled>Thanh toÃ¡n</button>
                    <button id="cancelOrderBtn" disabled class="cancel-btn">Há»§y Order</button>
                </div>

                <div class="bill-details">
                    <h3>Chi tiáº¿t Bill</h3>
                    <p>Tiá»n mÃ³n: <span id="billSubtotal">0</span> VND</p>
                    <p>Giáº£m giÃ¡:
                        <input type="number" id="discountInput" value="0" min="0" max="100" style="width: 50px;"> %
                        <span id="discountAmountSpan">(0 VND)</span>
                    </p>
                    <p class="final-total">ThÃ nh tiá»n: <span id="billTotalFinal">0</span> VND</p>
                    <button id="confirmPaymentBtn" disabled>XÃ¡c nháº­n Thanh toÃ¡n</button>
                </div>
            </div>
        </div>
    </div>
    <div id="hamburgerMenu" class="hamburger-menu">
    <button id="hamburgerBtn" class="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div id="navLinks" class="nav-links">
        <a href="staff.html" class="nav-button">ğŸ§‘â€ğŸ’¼ Quáº£n LÃ½ NhÃ¢n ViÃªn</a>
        <a href="revenue.html" class="nav-button">ğŸ“Š BÃ¡o CÃ¡o Doanh thu</a>
        <a href="add_dish.html" class="nav-button">â• ThÃªm MÃ³n Ä‚n</a>
        <a href="#" class="nav-button delete-dish-button">âŒ XÃ³a MÃ³n Ä‚n</a>
        <a href="#" class="nav-button edit-price-button" id="openEditPriceBtn">ğŸ’° Chá»‰nh Sá»­a GiÃ¡</a>
        <a href="ingredients.html" class="nav-button">ğŸ“¦ Kho nguyÃªn liá»‡u</a>
         <a href="change_password.html" class="nav-button">ğŸ”‘Äá»•i Máº­t Kháº©u</a>
        <a href="#" class="nav-button logout-button" id="logoutBtn">ğŸ”’ ÄÄƒng Xuáº¥t</a>
    </div>
</div>

    <!-- Modal chá»n mÃ³n Ä‘á»ƒ xÃ³a -->
    <div id="deleteDishModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>Chá»n mÃ³n Ä‘á»ƒ xÃ³a</h3>
            <ul id="dishDeleteList" class="dish-delete-list"></ul>
            <button id="closeDeleteModal" class="modal-close-btn">ÄÃ³ng</button>
        </div>
    </div>

    
    <script src="script.js"></script>

    <!-- Modal hÃ³a Ä‘Æ¡n -->
    <div id="invoiceModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" id="invoiceContent">
            <h3>HÃ“A ÄÆ N THANH TOÃN</h3>
            <div id="invoiceDetails"></div>
            <div style="text-align:center; margin-top: 15px;">
                <button onclick="window.print()">ğŸ–¨ In hÃ³a Ä‘Æ¡n</button>
                <button onclick="closeInvoiceModal()">ÄÃ³ng</button>
            </div>
        </div>
    </div>

    <!-- jsPDF cho tÃ­nh nÄƒng xuáº¥t PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Modal chá»‰nh sá»­a giÃ¡ bÃ¡n -->
    <div id="editPriceModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>Chá»‰nh Sá»­a GiÃ¡ MÃ³n Ä‚n</h3>
            <label for="editDishSelect">Chá»n mÃ³n Äƒn:</label>
            <select id="editDishSelect" style="width: 100%; padding: 8px; margin-bottom: 10px;"></select>

            <label for="newPriceInput">GiÃ¡ má»›i (VND):</label>
            <input type="number" id="newPriceInput" style="width: 100%; padding: 8px;" />

            <button id="saveNewPriceBtn" class="save-price-btn">LÆ°u</button>
            <button id="closeEditPriceBtn" class="modal-close-btn" style="margin-top: 10px;">ÄÃ³ng</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', () => {
            if (confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n Ä‘Äƒng xuáº¥t?")) {
                sessionStorage.clear(); // XÃ³a toÃ n bá»™ session trÃªn trÃ¬nh duyá»‡t
                window.location.href = "login.html"; // Quay vá» trang Ä‘Äƒng nháº­p
            }
        });
    }
    });
    </script>

</body>
</html>
