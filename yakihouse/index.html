<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω G·ªçi M√≥n & T√≠nh Bill</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Ki·ªÉm tra ƒëƒÉng nh·∫≠p v√† ph√¢n quy·ªÅn -->
    <script>
        const isLoggedIn = sessionStorage.getItem('isLoggedIn');
        if (isLoggedIn !== 'true') {
            alert('B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ s·ª≠ d·ª•ng h·ªá th·ªëng!');
            window.location.href = 'login.html?redirect=index';
        }
    </script>

    <div class="container">
        <div class="header-logo">
            <img src="image/logo.png" alt="Logo" />
        </div>
        <h1>Qu·∫£n L√Ω G·ªçi M√≥n & Thanh To√°n</h1>

        <div class="table-selection-section">
            <h2>Ch·ªçn B√†n</h2>
            <div id="tableList" class="table-grid">
                <!-- B√†n s·∫Ω ƒë∆∞·ª£c render b·ªüi script.js -->
            </div>
            <p id="selectedTableInfo">Ch∆∞a ch·ªçn b√†n n√†o.</p>
        </div>

        <div class="main-order-section">
            <div class="menu-section">
                <h2>Th·ª±c ƒë∆°n</h2>
                <div id="menuItems" class="menu-grid">
                </div>
            </div>

            <div class="order-bill-section">
                <h2>ƒê∆°n h√†ng b√†n: <span id="currentTableName">Ch∆∞a ch·ªçn</span></h2>
                <div class="order-summary">
                    <ul id="orderList">
                        <li class="empty-order-message">Ch·ªçn b√†n v√† th√™m m√≥n ƒë·ªÉ b·∫Øt ƒë·∫ßu order.</li>
                    </ul>
                    <p class="total-amount">T·ªïng c·ªông: <span id="totalAmount">0</span> VND</p>
                    <button id="checkoutBtn" disabled>Thanh to√°n</button>
                    <button id="cancelOrderBtn" disabled class="cancel-btn">H·ªßy Order</button>
                </div>

                <div class="bill-details">
                    <h3>Chi ti·∫øt Bill</h3>
                    <p>Ti·ªÅn m√≥n: <span id="billSubtotal">0</span> VND</p>
                    <p>Gi·∫£m gi√°:
                        <input type="number" id="discountInput" value="0" min="0" max="100" style="width: 50px;"> %
                        <span id="discountAmountSpan">(0 VND)</span>
                    </p>
                    <p class="final-total">Th√†nh ti·ªÅn: <span id="billTotalFinal">0</span> VND</p>
                    <button id="confirmPaymentBtn" disabled>X√°c nh·∫≠n Thanh to√°n</button>
                </div>
            </div>
        </div>
    </div>
    <div id="hamburgerMenu" class="hamburger-menu">
    <button id="hamburgerBtn" class="hamburger-btn">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div id="navLinks" class="nav-links">
        <a href="staff.html" class="nav-button">üßë‚Äçüíº Qu·∫£n L√Ω Nh√¢n Vi√™n</a>
        <a href="revenue.html" class="nav-button">üìä B√°o C√°o Doanh thu</a>
        <a href="add_dish.html" class="nav-button">‚ûï Th√™m M√≥n ƒÇn</a>
        <a href="#" class="nav-button delete-dish-button">‚ùå X√≥a M√≥n ƒÇn</a>
        <a href="#" class="nav-button edit-price-button" id="openEditPriceBtn">üí∞ Ch·ªânh S·ª≠a Gi√°</a>
        <a href="ingredients.html" class="nav-button">üì¶ Kho nguy√™n li·ªáu</a>
        <a href="shifts_report.html" class="nav-button">üìã Qu·∫£n l√Ω ca l√†m vi·ªác</a>
        <a href="change_password.html" class="nav-button">üîëƒê·ªïi M·∫≠t Kh·∫©u</a>
        <a href="#" class="nav-button logout-button" id="logoutBtn">üîí ƒêƒÉng Xu·∫•t</a>
        <div class="shift-info-section" style="text-align: center; margin-bottom: 20px;">
            <p>Ch√†o b·∫°n, <strong id="staffNameDisplay"></strong>!</p>
            <p>Tr·∫°ng th√°i: <span id="shiftStatusDisplay" style="font-weight: bold;"></span></p>
    <div class="shift-buttons">
        <button id="checkInBtn" style="background-color: #28a745; display: none;">Check-in</button>
        <button id="checkOutBtn" style="background-color: #dc3545; display: none;">Check-out</button>
    </div>
</div>
    </div>

</div>

    <!-- Modal ch·ªçn m√≥n ƒë·ªÉ x√≥a -->
    <div id="deleteDishModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>Ch·ªçn m√≥n ƒë·ªÉ x√≥a</h3>
            <ul id="dishDeleteList" class="dish-delete-list"></ul>
            <button id="closeDeleteModal" class="modal-close-btn">ƒê√≥ng</button>
        </div>
    </div>

    
    <script src="script.js"></script>

    <!-- Modal h√≥a ƒë∆°n -->
    <div id="invoiceModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" id="invoiceContent">
            <h3>H√ìA ƒê∆†N THANH TO√ÅN</h3>
            <div id="invoiceDetails"></div>
            <div style="text-align:center; margin-top: 15px;">
                <button onclick="window.print()">üñ® In h√≥a ƒë∆°n</button>
                <button onclick="closeInvoiceModal()">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- jsPDF cho t√≠nh nƒÉng xu·∫•t PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Modal ch·ªânh s·ª≠a gi√° b√°n -->
    <div id="editPriceModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>Ch·ªânh S·ª≠a Gi√° M√≥n ƒÇn</h3>
            <label for="editDishSelect">Ch·ªçn m√≥n ƒÉn:</label>
            <select id="editDishSelect" style="width: 100%; padding: 8px; margin-bottom: 10px;"></select>

            <label for="newPriceInput">Gi√° m·ªõi (VND):</label>
            <input type="number" id="newPriceInput" style="width: 100%; padding: 8px;" />

            <button id="saveNewPriceBtn" class="save-price-btn">L∆∞u</button>
            <button id="closeEditPriceBtn" class="modal-close-btn" style="margin-top: 10px;">ƒê√≥ng</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const logoutBtn = document.getElementById('logoutBtn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', () => {
            if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?")) {
                sessionStorage.clear(); 
                window.location.href = "login.html";
            }
        });
    }
    });
    </script>

</body>
</html>
